

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RNAlysis user guide &mdash; RNAlysis 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> RNAlysis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">RNAlysis - RNA sequencing data analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">RNAlysis user guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rnalysis-filtering-module">RNAlysis filtering module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#working-with-filter-objects">Working with Filter objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialize-a-filter-object">Initialize a Filter object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-a-filter-object">View a Filter object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-operations">Filtering operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-set-operations-on-multiple-filter-objects">Performing set operations on multiple Filter objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saving-filter-results">Saving Filter results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-an-attribute-reference-table-for-filter-operations">Using an Attribute Reference Table for filter operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-a-biotype-reference-table-for-filter-operations">Using a Biotype Reference Table for filter operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#filtering-deseq2-output-files-with-filtering-deseqfilter">Filtering DESeq2 output files with filtering.DESeqFilter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-from-a-csv-file">Loading from a .csv file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-operations-unique-to-deseqfilter">Filtering operations unique to DESeqFilter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#filtering-htseq-count-output-files-with-filtering-countfilter">Filtering HTSeq-count output files with filtering.CountFilter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-an-countfilter-object-from-a-folder-of-htseq-count-output-txt-files">Generating an CountFilter object from a folder of HTSeq-count output .txt files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-from-a-pre-made-csv-file">Loading from a pre-made .csv file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-operations-unique-to-countfilter">Filtering operations unique to CountFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#normalizing-reads-with-countfilter">Normalizing reads with CountFilter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-visualization-and-clustering-analysis-with-countfilter">Data visualization and clustering analysis with CountFilter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#filtering-fold-change-data-of-features-using-filtering-foldchangefilter">Filtering fold-change data of features using filtering.FoldChangeFilter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-fold-change-data-from-a-csv-file">Loading fold change data from a .csv file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-fold-change-data-from-an-existing-countfilter-object">Generating fold change data from an existing CountFilter object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-randomization-tests-on-a-foldchangefilter-object">Performing randomization tests on a FoldChangeFilter object</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rnalysis-enrichment-module">RNAlysis enrichment module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#working-with-featureset-objects">Working with FeatureSet objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialize-an-featureset-object">Initialize an FeatureSet object</a></li>
<li class="toctree-l4"><a class="reference internal" href="#randomization-test-enrichment-analysis-for-user-defined-attributes">Randomization test enrichment analysis for user-defined attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-set-operations-on-multiple-featureset-objects">Performing set operations on multiple FeatureSet objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="#saving-indices-from-featureset-to-a-txt-file">Saving indices from FeatureSet to a .txt file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rnalysis-general-module">RNAlysis general module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#start-and-stop-a-parallel-processing-session">Start and stop a parallel processing session</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-and-load-a-reference-table">Set and load a Reference Table</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#what-is-an-attribute-reference-table">What is an Attribute Reference Table?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-is-a-biotype-reference-table">What is a Biotype Reference Table?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-a-reference-table-as-default">Set a Reference Table as default</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-the-default-attribute-reference-table-path">Load the default Attribute Reference Table path</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parse-c-elegans-gene-names-wbgene-indices-and-sequence-names-using-regular-expressions">Parse <em>C. elegans</em> gene names, WBGene indices and sequence names using regular expressions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rnalysis.filtering.html">rnalysis.filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnalysis.enrichment.html">rnalysis.enrichment</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnalysis.general.html">rnalysis.general</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rnalysis.html">rnalysis package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">RNAlysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>RNAlysis user guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rnalysis_user_guide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rnalysis-user-guide">
<h1>RNAlysis user guide<a class="headerlink" href="#rnalysis-user-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rnalysis-filtering-module">
<h2>RNAlysis filtering module<a class="headerlink" href="#rnalysis-filtering-module" title="Permalink to this headline">¶</a></h2>
<p>RNAlysis’s filtering module (rnalysis.filtering) is built to allow rapid and easy to understand filtering of various forms of RNA sequencing data. The module also contains specific methods for visualization and clustering of data.</p>
<p>The filtering module is built around Filter objects, which are containers for tabular sequencing data. You can use the different types of Filter objects to apply filtering operations to various types of tabular data. You will learn more about Filter objects in the next section.</p>
<div class="section" id="working-with-filter-objects">
<h3>Working with Filter objects<a class="headerlink" href="#working-with-filter-objects" title="Permalink to this headline">¶</a></h3>
<p>All Filter objects (DESeqFilter, CountFilter, FoldChangeFilter) work on the same principles,
and share many of the same functions and features. Each of them also has specific filtering, analysis and visualisation functions. In this section we will look into the general usage of Filter objects.</p>
<div class="section" id="initialize-a-filter-object">
<h4>Initialize a Filter object<a class="headerlink" href="#initialize-a-filter-object" title="Permalink to this headline">¶</a></h4>
<p>We will start by importing the filtering module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">filtering</span>
</pre></div>
</div>
<p>We can now, for example, create a DESeqFilter object from a DESeq2 csv output file (see more details about DESeqFilter in sections below).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">DESeqFilter</span><span class="p">(</span><span class="s1">&#39;D:\myfolder\my_deseq2_output.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="view-a-filter-object">
<h4>View a Filter object<a class="headerlink" href="#view-a-filter-object" title="Permalink to this headline">¶</a></h4>
<p>In order to view a glimpse of the file we imported we can use the ‘head’ and ‘tail’ functions.
By default ‘head’ will show the first 5 rows of the file, and ‘tail’ will show the last 5 rows,
but you can specify a specific number of lines to show.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">d</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also see the total number of rows and columns by accessing the ‘shape’ attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<p>which will return the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">23735</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>meaning there are 23735 rows and 6 columns in the file.</p>
</div>
<div class="section" id="filtering-operations">
<h4>Filtering operations<a class="headerlink" href="#filtering-operations" title="Permalink to this headline">¶</a></h4>
<p>Now we can start filtering the entries in the file according to parameters of our choosing.
Various filtering operations are applied directly to the Filter object. Those operations do not affect the original csv file, but its representation within the Filter object.
For example, we can the function ‘filter_percentile’ to remove all rows that are above the specified percentile (in our example, 75% percentile) in the specified column (in our example, ‘log2FoldChange’):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">filter_percentile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="s1">&#39;log2FoldChange&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If we now look at the shape of d, we will see that 5954 rows have been filtered out of the object, and we remain with 17781 rows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">17781</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, filtering operations on Filter objects are performed in-place, meaning the original object is modified. However, we can save the results into a new Filter object and leave the current object unaffected by passing the argument ‘inplace=False’ to any filtering function within RNAlysis. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d_filtered</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">filter_percentile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span><span class="s1">&#39;log2FoldChange&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the object ‘d’ will remain unchanged, while ‘d_filtered’ will be a new Filter object which contains our filtered results. We can continue applying filters sequentially to the same Filter object, or using ‘inplace=False’ to create a new object at any point.</p>
<p>Another useful option is to perform an opposite filter. When we specify the parameter ‘opposite=True’ to any filtering function within RNAlysis, the filtering function will be performed in opposite. This means that all of the genomic features that were supposed to be filtered out are kept in the object, and the genomic features that were supposed to be kept in the object are filtered out.
For example, if we now wanted to remove the rows which are below the 25% percentile in the ‘log2FoldChange’ column, we will use the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">filter_percentile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="s1">&#39;log2FoldChange&#39;</span><span class="p">,</span><span class="n">opposite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Calling this function without the ‘opposite’ parameter would have removed all values except the bottom 25% of the ‘log2FoldChange’ column. When specifying ‘opposite’, we instead throw out the bottom 25% of the ‘log2FoldChange’ column and keep the rest.</p>
<p>There are many different filtering functions within the filtering module. Some of them are subtype-specific (such as ‘filter_low_reads’ for CountFilter objects and ‘filter_significant’ for DESeqFilter objects), while others can be applied to any Filter object. You can read more about the different functions and their usage in the project’s documentation.</p>
</div>
<div class="section" id="performing-set-operations-on-multiple-filter-objects">
<h4>Performing set operations on multiple Filter objects<a class="headerlink" href="#performing-set-operations-on-multiple-filter-objects" title="Permalink to this headline">¶</a></h4>
<p>In addition to using regular filters, it is also possible to use set operations such as union, intersection, difference and symmetric difference to combine the results of multiple Filter objects. Those set operations can be applied to any Filter object, as well as to python sets. The objects don’t have to be of the same subtype - you can, for example, look at the union of a DESeqFilter object, an CountFilter object and a python set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">DESeqFilter</span><span class="p">(</span><span class="s1">&#39;deseqfile.csv&#39;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;htseq_count_file.csv&#39;</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;WBGene00000001&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00000002&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00000003&#39;</span><span class="p">}</span>
<span class="n">union_result</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>When performing set operations, the return type can be either a python set (default) or a string. This means you can use the output of the set operation as an input for yet another set operation. However, since the returned object is a set you cannot use Filter object functions such as ‘head’ and ‘save_csv’ on it, or apply filters to it directly. Intersection and Difference in particular can be used in-place, which applies the filtering to the first Filter object.</p>
</div>
<div class="section" id="saving-filter-results">
<h4>Saving Filter results<a class="headerlink" href="#saving-filter-results" title="Permalink to this headline">¶</a></h4>
<p>At any point we can save the current result of our filtering to a new csv file, by using the ‘save_csv’ function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">save_csv</span><span class="p">()</span>
</pre></div>
</div>
<p>If no filename is specified, the file is given a name automatically based on the filtering operations performed on it, their order and their parameters.
We can view the current automatic filename by looking at the ‘fname’ attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">fname</span>
</pre></div>
</div>
<p>In this example, the automatic filename is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;D:/myfolder/my_deseq2_output_below0.75percentile_below0.25percentileopposite.csv&#39;</span>
</pre></div>
</div>
<p>Alternatively, you can specify a filename:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">save_csv</span><span class="p">(</span><span class="s1">&#39;alt_filename&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Instead of directly saving the results to a file, you can also get them as a set or string of genomic feature indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_output</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index_set</span>
<span class="n">str_output</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index_string</span>
</pre></div>
</div>
<p>Sets of genomic feature indices can be used later for enrichment analysis using the enrichment module (see below).</p>
</div>
<div class="section" id="using-an-attribute-reference-table-for-filter-operations">
<h4>Using an Attribute Reference Table for filter operations<a class="headerlink" href="#using-an-attribute-reference-table-for-filter-operations" title="Permalink to this headline">¶</a></h4>
<p>An Attribute Reference Table contains various user-defined attributes (such as ‘genes expressed in intestine’, ‘epigenetic genes’ or ‘genes that have paralogs’) and their value for each genomic feature.
You can read more about the Attribute Reference Table format and loading an Attribute Reference Table in the <a class="reference internal" href="#reference-table-ref"><span class="std std-ref">Set and load a Reference Table</span></a> section.
Using the function Filter.filter_by_attribute(), you can filter your genomic features by one of the user-defined attributes in the Reference Table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">filter_by_attribute</span><span class="p">(</span><span class="s1">&#39;genes_that_have_a_paralog&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-a-biotype-reference-table-for-filter-operations">
<h4>Using a Biotype Reference Table for filter operations<a class="headerlink" href="#using-a-biotype-reference-table-for-filter-operations" title="Permalink to this headline">¶</a></h4>
<p>A Biotype Reference Table contains annotations of the biotype of each genomic features (‘protein_coding’, ‘piRNAs’, ‘lincRNAs’, ‘pseudogenes’, etc).
You can read more about the Biotype Reference Table format and loading a Biotype Reference Table in the <a class="reference internal" href="#reference-table-ref"><span class="std std-ref">Set and load a Reference Table</span></a> section.
Using the function Filter.filter_biotype(), you can filter your genomic features by their annotated biotype in the Biotype Reference Table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">filter_biotype</span><span class="p">(</span><span class="s1">&#39;protein_coding&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also view the number of genomic features belonging to each biotype using the function Filter.biotypes():</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">biotypes</span><span class="p">()</span>
</pre></div>
</div>
<p>Or view more elaborated descriptive statistics for eahc biotype by specifying format=’long’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="o">.</span><span class="n">biotypes</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;long&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="filtering-deseq2-output-files-with-filtering-deseqfilter">
<h3>Filtering DESeq2 output files with filtering.DESeqFilter<a class="headerlink" href="#filtering-deseq2-output-files-with-filtering-deseqfilter" title="Permalink to this headline">¶</a></h3>
<p>DESeqFilter objects are built to easily filter the output of R’s DESeq2 package. This package is meant to analyze differential expression of genomic features in sequencing data. You can read more about it here: {}
Like other filter objects, filtering operations on DESeqFilter are performed in-place by default,meaning the original object is modified.</p>
<p>In principle, any .csv file that contains differential expression analysis data with log2 fold change and adjusted p values can be used as input for DESeqFilter.
However, some DESeqFilter functions (such as ‘filter_significant’ and ‘filter_abs_log2_fold_change’) may only work on DESeq2 output files, and other unintended interactions may occur.</p>
<p>A correct input to a DESeqFilter object would follow the following format:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 12%" />
<col style="width: 20%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
<col style="width: 12%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>baseMean</p></th>
<th class="head"><p>log2FoldChange</p></th>
<th class="head"><p>lfcSE</p></th>
<th class="head"><p>stat</p></th>
<th class="head"><p>pvalue</p></th>
<th class="head"><p>padj</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WBGene00000021</p></td>
<td><p>2688.044</p></td>
<td><p>3.329404</p></td>
<td><p>0.158938</p></td>
<td><p>20.94783</p></td>
<td><p>1.96E-97</p></td>
<td><p>1.80E-94</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000022</p></td>
<td><p>365.813</p></td>
<td><p>6.101303</p></td>
<td><p>0.291484</p></td>
<td><p>20.93189</p></td>
<td><p>2.74E-97</p></td>
<td><p>2.40E-94</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000023</p></td>
<td><p>3168.567</p></td>
<td><p>3.906719</p></td>
<td><p>0.190439</p></td>
<td><p>20.51433</p></td>
<td><p>1.60E-93</p></td>
<td><p>1.34E-90</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000024</p></td>
<td><p>221.9257</p></td>
<td><p>4.801676</p></td>
<td><p>0.246313</p></td>
<td><p>19.49419</p></td>
<td><p>1.23E-84</p></td>
<td><p>9.82E-82</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000025</p></td>
<td><p>2236.186</p></td>
<td><p>2.477374</p></td>
<td><p>0.129606</p></td>
<td><p>19.11463</p></td>
<td><p>1.91E-81</p></td>
<td><p>1.46E-78</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000026</p></td>
<td><p>343.649</p></td>
<td><p>-4.03719</p></td>
<td><p>0.219781</p></td>
<td><p>-18.3691</p></td>
<td><p>2.32E-75</p></td>
<td><p>1.70E-72</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000027</p></td>
<td><p>175.1429</p></td>
<td><p>6.352044</p></td>
<td><p>0.347777</p></td>
<td><p>18.26471</p></td>
<td><p>1.58E-74</p></td>
<td><p>1.12E-71</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000028</p></td>
<td><p>219.1632</p></td>
<td><p>3.913657</p></td>
<td><p>0.217802</p></td>
<td><p>17.96885</p></td>
<td><p>3.42E-72</p></td>
<td><p>2.32E-69</p></td>
</tr>
</tbody>
</table>
<div class="section" id="loading-from-a-csv-file">
<h4>Loading from a .csv file<a class="headerlink" href="#loading-from-a-csv-file" title="Permalink to this headline">¶</a></h4>
<p>Loading a file into a DESeqFilter works as explained above for any Filter object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">DESeqFilter</span><span class="p">(</span><span class="s1">&#39;my_file.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="filtering-operations-unique-to-deseqfilter">
<h4>Filtering operations unique to DESeqFilter<a class="headerlink" href="#filtering-operations-unique-to-deseqfilter" title="Permalink to this headline">¶</a></h4>
<p>There are a few filtering operations unique to DESeqFilter. Those include ‘filter_significant’, which removes statistically-insignificant rows according to a specified threshold; ‘filter_abs_log2_fold_change’, removes rows whose absolute value log2 fold change is below the specified threshold; ‘filter_fold_change_direction’ which removes either up-regulated (positive log2 fold change) or down-regulated (negative log2 fold change) rows; and ‘split_fold_change_direction’ which returns a DESeqFilter object with only up-regulated features and a DESeqFilter object with only down-regulated features.</p>
<p>The unique DESeqFilter filter operations expect specific column names (the column names automatically generated by DESeq2), and will not work with other column names:
‘log2FoldChange’,’pval’,’padj’.</p>
</div>
</div>
<div class="section" id="filtering-htseq-count-output-files-with-filtering-countfilter">
<h3>Filtering HTSeq-count output files with filtering.CountFilter<a class="headerlink" href="#filtering-htseq-count-output-files-with-filtering-countfilter" title="Permalink to this headline">¶</a></h3>
<p>You can read more about HTSeq-count here:
<a class="reference external" href="https://htseq.readthedocs.io/en/release_0.11.1/count.html">https://htseq.readthedocs.io/en/release_0.11.1/count.html</a></p>
<p>In principle, any .csv file where the columns are different conditions/replicates and the rows include reads/normalized reads per genomic feature can be used as input for CountFilter. However, some CountFilter functions (such as ‘norm_reads_to_rpm’) will only work on HTSeq-count output files, and other unintended interactions may occur.</p>
<div class="section" id="generating-an-countfilter-object-from-a-folder-of-htseq-count-output-txt-files">
<span id="from-folder-ref"></span><h4>Generating an CountFilter object from a folder of HTSeq-count output .txt files<a class="headerlink" href="#generating-an-countfilter-object-from-a-folder-of-htseq-count-output-txt-files" title="Permalink to this headline">¶</a></h4>
<p>HTSeq-count receives as input an aligned SAM/BAM file. The native output of HTSeq-count is a text file with feature indices and read-per-genomic-feature, as well as information about reads that weren’t counted for any feature (alignment not unique, low alignment quality, ambiguous, unaligned, aligned to no feature).
An HTSeq-count output file would follow the following format:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 83%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>WBGene00000001</p></td>
<td><p>376</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000002</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000003</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000004</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000005</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000006</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000007</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000008</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00000009</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00000010</p></td>
<td><p>177</p></td>
</tr>
<tr class="row-odd"><td><p>__no_feature</p></td>
<td><p>32</p></td>
</tr>
<tr class="row-even"><td><p>__ambiguous</p></td>
<td><p>12</p></td>
</tr>
<tr class="row-odd"><td><p>__too_low_aQual</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>__not_aligned</p></td>
<td><p>121</p></td>
</tr>
<tr class="row-odd"><td><p>__alignment_not_unique</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<p>When running HTSeq-count on multiple SAM files (which could represent different conditions or replicates), the final output would be a directory of .txt files. RNAlysis can parse those .txt files into two .csv tables: in the first each row is a genomic feature and each column is a condition or replicate (a single .txt file), and in the second each row represents a category of reads not mapped to genomic features (alignment not unique, low alignment quality, etc). This is done with the ‘from_folder’ function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="s1">&#39;my_folder_path&#39;</span><span class="p">,</span> <span class="n">counted_fname</span><span class="o">=</span><span class="s1">&#39;name_for_reads_csv_file&#39;</span><span class="p">,</span> <span class="n">uncounted_fname</span><span class="o">=</span><span class="s1">&#39;name_for_unmapped_reads_csv_file&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By deault, ‘from_folder’ saves the generated tables as .csv files. However, you can avoid that by specifying ‘save_csv=False’.
It is also possible to automatically normalize the reads in the new CountFilter object to reads per million (RPM) using the unmapped reads data by specifying ‘norm_to_rpm=True’.</p>
</div>
<div class="section" id="loading-from-a-pre-made-csv-file">
<h4>Loading from a pre-made .csv file<a class="headerlink" href="#loading-from-a-pre-made-csv-file" title="Permalink to this headline">¶</a></h4>
<p>If you have previously generated a .csv file from HTSeq-count output files using RNAlysis, or have done so manually, you can directly load this .csv file into an CountFilter object as you would any other Filter object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;my_csv_file.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A correct input to a CountFilter object would follow the following format:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>cond1</p></th>
<th class="head"><p>cond2</p></th>
<th class="head"><p>cond3</p></th>
<th class="head"><p>cond4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WBGene00007063</p></td>
<td><p>633</p></td>
<td><p>451</p></td>
<td><p>365</p></td>
<td><p>388</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00007064</p></td>
<td><p>60</p></td>
<td><p>57</p></td>
<td><p>20</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00044951</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00007066</p></td>
<td><p>55</p></td>
<td><p>266</p></td>
<td><p>46</p></td>
<td><p>39</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00007067</p></td>
<td><p>15</p></td>
<td><p>13</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00007069</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00077502</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene00077503</p></td>
<td><p>1</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>WBGene00077504</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="filtering-operations-unique-to-countfilter">
<h4>Filtering operations unique to CountFilter<a class="headerlink" href="#filtering-operations-unique-to-countfilter" title="Permalink to this headline">¶</a></h4>
<p>There are a few filtering operations unique to CountFilter. Those include ‘filter_low_reads’, which removes rows that have less than n reads in all columns.</p>
</div>
<div class="section" id="normalizing-reads-with-countfilter">
<h4>Normalizing reads with CountFilter<a class="headerlink" href="#normalizing-reads-with-countfilter" title="Permalink to this headline">¶</a></h4>
<p>CountFilter offers two methods for normalizing reads: reads per million (RPM) and DESeq2’s size factors. Data normalized in other methods (such as RPKM) can be used as input for CountFilter, but it cannot perform such normalization methods on its own.</p>
<p>To normalize a CountFilter that originated from HTSeq-count to reads per million, we need a .csv table with the special counters that appear in HTSeq-count output:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>sample1</p></th>
<th class="head"><p>sample2</p></th>
<th class="head"><p>sample3</p></th>
<th class="head"><p>sample4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>__ambiguous</p></td>
<td><p>37</p></td>
<td><p>12</p></td>
<td><p>145</p></td>
<td><p>77</p></td>
</tr>
<tr class="row-odd"><td><p>__no_feature</p></td>
<td><p>9468</p></td>
<td><p>11354</p></td>
<td><p>14009</p></td>
<td><p>30287</p></td>
</tr>
<tr class="row-even"><td><p>__alignment_not_unique</p></td>
<td><p>108</p></td>
<td><p>290</p></td>
<td><p>557</p></td>
<td><p>893</p></td>
</tr>
<tr class="row-odd"><td><p>__too_low_aQual</p></td>
<td><p>0</p></td>
<td><p>5</p></td>
<td><p>12</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-even"><td><p>__not_aligned</p></td>
<td><p>109853</p></td>
<td><p>277653</p></td>
<td><p>88653</p></td>
<td><p>96012</p></td>
</tr>
</tbody>
</table>
<p>Such a .csv table is generated automatically when you create a CountFilter object from a folder of text files (CountFilter.from_folder(), see <a class="reference internal" href="#from-folder-ref"><span class="std std-ref">Generating an CountFilter object from a folder of HTSeq-count output .txt files</span></a>).
We would then supply the normalization function with the path to the special counter file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;path_to_my_count_file.csv&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">norm_reads_to_rpm</span><span class="p">(</span><span class="s1">&#39;path_to_my_special_counter_table.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting CountFilter object will be normalized to RPM with the formula (1,000,000 * reads in cell) / (sum of aligned reads + __no_feature + __ambiguous + __alignment_no_unique)</p>
<p>To normalize a CountFilter with size factors, we need a .csv table with the size factor for each sample:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>sample1</p></th>
<th class="head"><p>sample2</p></th>
<th class="head"><p>sample3</p></th>
<th class="head"><p>sample4</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.96</p></td>
<td><p>1</p></td>
<td><p>0.78</p></td>
<td><p>1.23</p></td>
</tr>
</tbody>
</table>
<p>We would then supply the function with the path to the size factor file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;path_to_my_count_file.csv&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">norm_reads_with_size_factor</span><span class="p">(</span><span class="s1">&#39;path_to_my_size_factor_table.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting CountFilter object will be normalized with the size factors (dividing the value of each column by the value of the corresponding size factor).</p>
</div>
<div class="section" id="data-visualization-and-clustering-analysis-with-countfilter">
<h4>Data visualization and clustering analysis with CountFilter<a class="headerlink" href="#data-visualization-and-clustering-analysis-with-countfilter" title="Permalink to this headline">¶</a></h4>
<p>CountFilter includes multiple methods for visualization and clustering of count data.</p>
<p>With CountFilter.pairplot, you can get a quick overview of the distribution of counts within each sample, and the correlation between different samples:</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/pairplot.png"><img alt="_images/pairplot.png" src="_images/pairplot.png" style="width: 768.0px; height: 370.8px;" /></a>
<p class="caption"><span class="caption-text">Example output of CountFilter.pairplot()</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>With CountFilter.clustergram, you can cluster your samples according to specified distance and linkage metrics:</p>
<blockquote>
<div><div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/clustergram.png"><img alt="_images/clustergram.png" src="_images/clustergram.png" style="width: 768.0px; height: 370.8px;" /></a>
<p class="caption"><span class="caption-text">Example plot of CountFilter.clustergram()</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
<p>With CountFilter.pca, you can perform a principal component analysis and look for strong patterns in your dataset:</p>
<blockquote>
<div><div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/pca.png"><img alt="_images/pca.png" src="_images/pca.png" style="width: 768.0px; height: 370.8px;" /></a>
<p class="caption"><span class="caption-text">Example plot of CountFilter.pca()</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
<p>With CountFilter.plot_expression, you can examine the average expression of specific genomic features under the specific conditions:</p>
<blockquote>
<div><div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/plot_expression.png"><img alt="_images/plot_expression.png" src="_images/plot_expression.png" style="width: 605.4px; height: 441.59999999999997px;" /></a>
<p class="caption"><span class="caption-text">Example plot of CountFilter.plot_expression()</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="filtering-fold-change-data-of-features-using-filtering-foldchangefilter">
<h3>Filtering fold-change data of features using filtering.FoldChangeFilter<a class="headerlink" href="#filtering-fold-change-data-of-features-using-filtering-foldchangefilter" title="Permalink to this headline">¶</a></h3>
<p>FoldChangeFilter objects can perform filtering operations and randomization tests on fold change values between two conditions.</p>
<p>A FoldChangeFilter object can be calculated from a CountFilter object (you can read more about it in the <a class="reference internal" href="#fold-change-from-count-ref"><span class="std std-ref">Generating fold change data from an existing CountFilter object</span></a>), or imported from a .csv file like other Filter objects.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>by default, FoldChangeFilter assumes that fold change is calculated as (numerator_reads+1)/(denominator_reads+1), and does not support 0 and inf values. If you load a .csv file which contains 0 and/or inf values into a FoldChangeFilter object, unintended results and interactions may occur.</p>
</div>
<p>Unlike other Filter object, the underlying data structure storing the values is a pandas Series and not a pandas DataFrame, and lacks the Columns attribute.</p>
<div class="section" id="loading-fold-change-data-from-a-csv-file">
<h4>Loading fold change data from a .csv file<a class="headerlink" href="#loading-fold-change-data-from-a-csv-file" title="Permalink to this headline">¶</a></h4>
<p>Like with other objects from the Filter family, you can simply load a pre-existing or pre-calculated .csv file into a FoldChangeFilter object. However, in addition to the file path you will also have to enter the name of the numerator condition and the name of the denominator condition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">FoldChangeFilter</span><span class="p">(</span><span class="s1">&#39;path_to_file.csv&#39;</span><span class="p">,</span><span class="s1">&#39;name of numerator condition&#39;</span><span class="p">,</span> <span class="s1">&#39;name of denominator condition&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The names of the conditions are saved in the object attributes ‘numerator’ and ‘denominator’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="n">of</span> <span class="n">numerator</span> <span class="n">condition</span> <span class="o">|</span> <span class="n">name</span> <span class="n">of</span> <span class="n">denominator</span> <span class="n">condition</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>by default, FoldChangeFilter assumes that fold change is calculated as (mean_numerator_reads+1)/(mean_denominator_reads+1), and does not support 0 and inf values. If you load a .csv file which contains 0 and/or inf values into a FoldChangeFilter object, unintended results and interactions may occur.</p>
</div>
</div>
<div class="section" id="generating-fold-change-data-from-an-existing-countfilter-object">
<span id="fold-change-from-count-ref"></span><h4>Generating fold change data from an existing CountFilter object<a class="headerlink" href="#generating-fold-change-data-from-an-existing-countfilter-object" title="Permalink to this headline">¶</a></h4>
<p>Alternatively, you can generate a FoldChangeFilter object from count data in a CountFilter object. We will start by loading a CountFilter object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;path_of_my_count_matrix.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The CountFilter has the following columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;cond1_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond1_rep2&#39;</span><span class="p">,</span><span class="s1">&#39;cond2_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond2_rep2&#39;</span><span class="p">,</span><span class="s1">&#39;cond3_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond3_rep2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We will now calculate the fold change between the mean of condition1 and condition2. Fold change is calculated as (mean_numerator_reads+1)/(mean_denominator_reads+1). We will need to specify the numerator columns, the denominator columns, and the names of the numerator and denominator. Specifying names is optional - if no names are specified, they will be generator automatically from columns used as numerator and denominator. Since we have multiple replicates of each condition, we will specify all of them in a list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fold_change</span><span class="p">([</span><span class="s1">&#39;cond1_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond1_rep2&#39;</span><span class="p">],[</span><span class="s1">&#39;cond2_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond2_rep2&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>In this example we did not specify names for the numerator and denominator, and therefore they were generated automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">numerator</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="n">f</span><span class="o">.</span><span class="n">denominator</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Mean</span> <span class="n">of</span> <span class="p">[</span><span class="s1">&#39;cond1_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond1_rep2&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="n">Mean</span> <span class="n">of</span> <span class="p">[</span><span class="s1">&#39;cond2_rep1&#39;</span><span class="p">,</span><span class="s1">&#39;cond2_rep2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>We now have a FoldChangeFilter object that we can perform further filtering operations on.</p>
</div>
<div class="section" id="performing-randomization-tests-on-a-foldchangefilter-object">
<h4>Performing randomization tests on a FoldChangeFilter object<a class="headerlink" href="#performing-randomization-tests-on-a-foldchangefilter-object" title="Permalink to this headline">¶</a></h4>
<p>You can perform a randomization test to examine whether the fold change of a group of specific genomic features (for example, genes with a specific biological function) is significantly different than the fold change of a background set of genomic features.
To perform a randomization test you need two FoldChangeFilter objects: one which contains the fold change values of all background genes, and another which contains the fold change values of your specific group of interest. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">FoldChangeFilter</span><span class="p">(</span><span class="s1">&#39;pre_existing_fold_change_file.csv&#39;</span> <span class="p">,</span> <span class="s1">&#39;numerator&#39;</span> <span class="p">,</span> <span class="s1">&#39;denominator&#39;</span><span class="p">)</span>
<span class="n">f_background</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">filter_biotype</span><span class="p">(</span><span class="s1">&#39;protein_coding&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1">#keep only protein-coding genes as reference)</span>
<span class="n">f_test</span> <span class="o">=</span> <span class="n">f_background</span><span class="o">.</span><span class="n">filter_by_attribute</span><span class="p">(</span><span class="s1">&#39;epigenetic_genes&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">rand_test_res</span> <span class="o">=</span> <span class="n">f_test</span><span class="o">.</span><span class="n">randomization_test</span><span class="p">(</span><span class="n">f_background</span><span class="p">)</span>
</pre></div>
</div>
<p>The output table would look like this:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 29%" />
<col style="width: 29%" />
<col style="width: 10%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>group size</p></th>
<th class="head"><p>observed fold change</p></th>
<th class="head"><p>expected fold change</p></th>
<th class="head"><p>pval</p></th>
<th class="head"><p>significant</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>220</p></td>
<td><p>2.271681</p></td>
<td><p>0.825341</p></td>
<td><p>0.0001</p></td>
<td><p>TRUE</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="rnalysis-enrichment-module">
<h2>RNAlysis enrichment module<a class="headerlink" href="#rnalysis-enrichment-module" title="Permalink to this headline">¶</a></h2>
<p>RNAlysis’s enrichment module (rnalysis.enrichment) can be used to perform various enrichment analyses including gene ontology (GO) enrichment and enrichment for user-defined attributes. The module also includes basic set operations (union, intersection, difference, symmetric difference) between different sets of genomic features.</p>
<div class="section" id="working-with-featureset-objects">
<h3>Working with FeatureSet objects<a class="headerlink" href="#working-with-featureset-objects" title="Permalink to this headline">¶</a></h3>
<p>The enrichment module is built around FeatureSet objects, which are a container for a set of genomic features and their name (for example, ‘genes that are upregulated under hyperosmotic conditions’). All further anslyses of the set of features is done through the FeatureSet object.</p>
<div class="section" id="initialize-an-featureset-object">
<h4>Initialize an FeatureSet object<a class="headerlink" href="#initialize-an-featureset-object" title="Permalink to this headline">¶</a></h4>
<p>We will start by importing the enrichment module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">enrichment</span>
</pre></div>
</div>
<p>An FeatureSet object can now be initialized by one of three methods.
The first method is to specify an existing Filter object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;path_to_my_file.csv&#39;</span><span class="p">)</span>
<span class="n">en</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">FeatureSet</span><span class="p">(</span><span class="n">filt</span><span class="p">,</span> <span class="s1">&#39;a name for my set&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The second method is to directly specify a python set of genomic feature indices, or a python set generated from an existing Filter object (see above for more information about Filter objects and the filtering module) using the function ‘index_set’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myset</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;WBGene00000001&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene0245200&#39;</span><span class="p">,</span><span class="s1">&#39; WBGene00402029&#39;</span><span class="p">}</span>
<span class="n">en</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">FeatureSet</span><span class="p">(</span><span class="n">myset</span><span class="p">,</span> <span class="s1">&#39;a name for my set&#39;</span><span class="p">)</span>
<span class="c1"># alternatively, using &#39;index_set&#39; on an existing Filter object:</span>
<span class="n">en2</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">FeatureSet</span><span class="p">(</span><span class="n">filt</span><span class="o">.</span><span class="n">index_set</span><span class="p">,</span><span class="s1">&#39; a name for my set&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The third method is not to specify a gene set at all:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">en</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">FeatureSet</span><span class="p">(</span><span class="n">set_name</span> <span class="o">=</span> <span class="s1">&#39;a name for my set&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, you will be prompted to enter a string of feature indices seperated by newline. They will be automatically paresd into a python set.</p>
<p>FeatureSet objects have two attributes: gene_set, a python set containing genomic feature indices; and set_name, a string that describes the feature set (optional).</p>
</div>
<div class="section" id="randomization-test-enrichment-analysis-for-user-defined-attributes">
<h4>Randomization test enrichment analysis for user-defined attributes<a class="headerlink" href="#randomization-test-enrichment-analysis-for-user-defined-attributes" title="Permalink to this headline">¶</a></h4>
<p>Using the enrichment module, you can perform enrichment analysis for user-defined attributes (such as ‘genes expressed in intestine’, ‘epigenetic genes’, ‘genes that have paralogs’). The enrichment analysis is performed using a randomization test.</p>
<p>Enrichment analysis is performed using either FeatureSet.enrich_randomization or FeatureSet.enrich_randomization_parallel. We will start by creating an FeatureSet object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">filtering</span><span class="o">.</span><span class="n">CountFilter</span><span class="p">(</span><span class="s1">&#39;path_to_my_file.csv&#39;</span><span class="p">)</span>
<span class="n">en</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">FeatureSet</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">index_set</span><span class="p">,</span> <span class="s1">&#39;my set&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Our attributes should be defined in a Reference Table csv file. You can read more about Reference Tables and their format in the section <a class="reference internal" href="#reference-table-ref"><span class="std std-ref">Set and load a Reference Table</span></a>.
Once we have a Reference Table, we can perform enrichment analysis for those attributes using the function FeatureSet.enrich_randomization.
If our Reference Table is set to be the default Reference Table (as explained in <a class="reference internal" href="#reference-table-ref"><span class="std std-ref">Set and load a Reference Table</span></a>) we do not need to specify it when calling enrich_randomization. Otherwise, we need to specify our Reference Table’s path.
The names of the attributes we want to calculate enrichment for can be specified as a list of names (for example, [‘attribute1’, ‘attribute2’]).</p>
<p>Next, we need to determine the set of genes to be used as background. Enrichment analysis is usually performed on protein-coding genes. Therefore, by default, enrich_randomization uses all of the protein-coding genes that appear in the Reference Table as a background set.
There are two methods of changing the default background set:</p>
<p>The first method is to specify a biotype (such as ‘protein_coding’, ‘miRNA’ or ‘all’) under the parameter ‘biotype’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">en</span><span class="o">.</span><span class="n">enrich_randomization</span><span class="p">([</span><span class="s1">&#39;attribute1&#39;</span><span class="p">,</span><span class="s1">&#39;attribute2&#39;</span><span class="p">],</span> <span class="n">biotype</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, instead of using all of the protein-coding genes in the Reference Table as background, we use all of the genomic features in the Reference Table as background.
When specifying a biotype, an internal reference file is used to categorize different genomic features into different biotypes.</p>
<p>The second method of changing the background set is to define a specific set of genomic features to be used as background:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_background_set</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;feature1&#39;</span><span class="p">,</span><span class="s1">&#39;feature2&#39;</span><span class="p">,</span><span class="s1">&#39;feature3&#39;</span><span class="p">}</span>
<span class="n">en</span><span class="o">.</span><span class="n">enrich_randomization</span><span class="p">([</span><span class="s1">&#39;attribute1&#39;</span><span class="p">,</span><span class="s1">&#39;attribute2&#39;</span><span class="p">],</span> <span class="n">background_genes</span><span class="o">=</span><span class="n">my_background_set</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, our background set consists of feature1, feature2 and feature3.</p>
<p>It is not possible to specify both a biotype and a specific background set.</p>
<p>If some of the features in the background set or the enrichment set do no appear in the Reference Table, they will be ignored when calculating enrichment.</p>
<p>Calling enrich_randomization will perform a randomization test for each of the specified attributes, and return a pandas DataFrame with the following format:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 22%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 13%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>samples</p></th>
<th class="head"><p>n obs</p></th>
<th class="head"><p>n exp</p></th>
<th class="head"><p>log2_fold_enrichment</p></th>
<th class="head"><p>pval</p></th>
<th class="head"><p>padj</p></th>
<th class="head"><p>significant</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>attribute1</p></td>
<td><p>1327</p></td>
<td><p>451</p></td>
<td><p>319.52</p></td>
<td><p>0.49722119558</p></td>
<td><p>0.0000999</p></td>
<td><p>0.0000999</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-odd"><td><p>attribute2</p></td>
<td><p>1327</p></td>
<td><p>89</p></td>
<td><p>244.87</p></td>
<td><p>-1.46013879322</p></td>
<td><p>0.0000999</p></td>
<td><p>0.0000999</p></td>
<td><p>True</p></td>
</tr>
</tbody>
</table>
<p>‘samples’ is the number of features that were used in the enrichment set. ‘n obs’ is the observed number of features positive for the attribute in the enrichment set.
‘n exp’ is the expected number of features positive for the attribute in the enrichment set. ‘log2_fold_enrichment’ is log2 of the fold change ‘n obs’/’n exp’.
enrich_randomization performs the number of randomizations specified by the user (10,000 by default), and marks each randomization as either a success or a failure.
The p values specified in ‘pval’ are calculated as (sucesses+1)/(repetitions+1). This is a positive-bias estimator of the exact p-value, which avoids exactly-zero p-values. You can read more about the topic in the following publication: <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/21044043">https://www.ncbi.nlm.nih.gov/pubmed/21044043</a></p>
<p>If we want to perform the enrichment analysis in parallel and save time, we could use the enrich_randomization_parallel function instead of enrich_randomization.
To use it, you must first start a parallel session:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">enrichment</span><span class="p">,</span> <span class="n">general</span>
<span class="n">general</span><span class="o">.</span><span class="n">start_parallel_session</span><span class="p">()</span>
</pre></div>
</div>
<p>To read more about parallel sessions, visit the <a class="reference internal" href="#parallel-ref"><span class="std std-ref">Start and stop a parallel processing session</span></a> section.
Afterwards, enrich_randomization_parallel is used exactly like enrich_randomization.</p>
</div>
<div class="section" id="performing-set-operations-on-multiple-featureset-objects">
<h4>Performing set operations on multiple FeatureSet objects<a class="headerlink" href="#performing-set-operations-on-multiple-featureset-objects" title="Permalink to this headline">¶</a></h4>
<p>Similarly to Filter objects, it is possible to use set operations such as union, intersection, difference and symmetric difference to combine the feature sets of multiple FeatureSet objects. Those set operations can be applied to both FeatureSet objects and python sets. The objects don’t have to be of the same subtype - you can, for example, look at the union of an FeatureSet object and a python set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">en</span> <span class="o">=</span> <span class="n">enrichment</span><span class="o">.</span><span class="n">FeatureSet</span><span class="p">({</span><span class="s1">&#39;WBGene00003002&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00004201&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00300139&#39;</span><span class="p">})</span>

<span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;WBGene00000001&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00000002&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00000003&#39;</span><span class="p">}</span>
<span class="n">union_result</span> <span class="o">=</span> <span class="n">en</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>When performing set operations, the return type will always be a python set. This means you can use the output of the set operation as an input for yet another set operation, or as input to a new FeatureSet object.</p>
</div>
<div class="section" id="saving-indices-from-featureset-to-a-txt-file">
<h4>Saving indices from FeatureSet to a .txt file<a class="headerlink" href="#saving-indices-from-featureset-to-a-txt-file" title="Permalink to this headline">¶</a></h4>
<p>It is possible to save the feature indices from an FeatureSet object to a .txt file, for use in online enrichment tools or simply to share the list of genomic features. This is done with the ‘save_txt’ function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">en</span><span class="o">.</span><span class="n">save_txt</span><span class="p">(</span><span class="s1">&#39;D:\path</span><span class="se">\f</span><span class="s1">ilename&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The feature indices will be saved to the text file in the specified path, separated by newline (‘n’).</p>
</div>
</div>
</div>
<div class="section" id="rnalysis-general-module">
<h2>RNAlysis general module<a class="headerlink" href="#rnalysis-general-module" title="Permalink to this headline">¶</a></h2>
<p>RNAlysis’s general module (rnalysis.general) contains general functions that can be useful during analysis of RNA sequencing data, including regular expression parsers and setting the Reference Table path.</p>
<div class="section" id="start-and-stop-a-parallel-processing-session">
<span id="parallel-ref"></span><h3>Start and stop a parallel processing session<a class="headerlink" href="#start-and-stop-a-parallel-processing-session" title="Permalink to this headline">¶</a></h3>
<p>Parallel processing in RNAlysis is performed using the ipyparallel package. You can read more about it here: <a class="reference external" href="https://ipyparallel.readthedocs.io/en/latest/">https://ipyparallel.readthedocs.io/en/latest/</a>
To use parallel processing features, you must first start an ipyparallel ipcluster. This is done using the general.start_parallel_session() function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">general</span>
<span class="n">general</span><span class="o">.</span><span class="n">start_parallel_session</span><span class="p">()</span>
</pre></div>
</div>
<p>Your python console will then become unavailable for 30 seconds while the ipcluster is being started.
By default, the parallel session will use all available processors on the machine to perform parallel processing. You can specify the exact number of processors you want to use in the current session.</p>
<p>start_parallel_session() will automatically close the previous parallel session, start a new session, and sleep for 30 seconds while the ipcluster is being started. You can perform the same operations manually in order to skip the sleep period:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">general</span>
<span class="n">general</span><span class="o">.</span><span class="n">start_ipcluster</span><span class="p">()</span>
<span class="c1">#perform parallel processing here</span>
<span class="n">general</span><span class="o">.</span><span class="n">stop_ipcluster</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="set-and-load-a-reference-table">
<span id="reference-table-ref"></span><h3>Set and load a Reference Table<a class="headerlink" href="#set-and-load-a-reference-table" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-is-an-attribute-reference-table">
<h4>What is an Attribute Reference Table?<a class="headerlink" href="#what-is-an-attribute-reference-table" title="Permalink to this headline">¶</a></h4>
<p>You can perform enrichment analysis or filtering operations based on user-defined attributes (such as ‘genes expressed in intestine’, ‘epigenetic genes’, ‘genes that have paralogs’).
User-defined attributes should be defined in an Attribute Reference Table csv file. The format of the Attribute Reference Table is one row for each gene/genomic feature, and one column for each attribute. Features that are negative for the attribute (for example, genes that have no paralogs under the attribute ‘genes that have paralogs’) should have the value NaN specified for the attribute, and features that are positive for the attribute (for example, genes that have paralogs under the attribute ‘genes that have paralogs’) should have any value other than NaN. The value could be either a boolean value (in our example, ‘True’ or ‘1’ for genes that have paralogs), a number (in our example, the number of paralogs the gene has or the genomic distance to the nearest paralog), or any other value which is not NaN. See example for an Attribute Reference Table below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 25%" />
<col style="width: 23%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>feature_indices</p></th>
<th class="head"><p>attribute1</p></th>
<th class="head"><p>attribute2</p></th>
<th class="head"><p>attribute3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WBGene0000001</p></td>
<td><p>1</p></td>
<td><p>NaN</p></td>
<td><p>13.7</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene0000002</p></td>
<td><p>NaN</p></td>
<td><p>1</p></td>
<td><p>241</p></td>
</tr>
<tr class="row-even"><td><p>WBGene0000003</p></td>
<td><p>NaN</p></td>
<td><p>1</p></td>
<td><p>3.6</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene0000004</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>NaN</p></td>
</tr>
<tr class="row-even"><td><p>WBGene0000005</p></td>
<td><p>1</p></td>
<td><p>NaN</p></td>
<td><p>21.5</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="what-is-a-biotype-reference-table">
<h4>What is a Biotype Reference Table?<a class="headerlink" href="#what-is-a-biotype-reference-table" title="Permalink to this headline">¶</a></h4>
<p>You can perform filtering operations or generate background-sets for enrichment analysis based on user-annotated biotypes (such as ‘protein_coding’, ‘pseudogene’, ‘piRNA’, etc).
User-annotated biotypes should be defined in a Biotype Reference Table csv file. The format of the Biotype Reference Table is one row for each gene/genomic feature, and a column titled ‘biotype’ (case insensitive). See example for a Biotype Reference Table below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>feature_indices</p></th>
<th class="head"><p>biotype</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>WBGene0000001</p></td>
<td><p>protein_coding</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene0000002</p></td>
<td><p>protein_coding</p></td>
</tr>
<tr class="row-even"><td><p>WBGene0000003</p></td>
<td><p>pseudogene</p></td>
</tr>
<tr class="row-odd"><td><p>WBGene0000004</p></td>
<td><p>piRNA</p></td>
</tr>
<tr class="row-even"><td><p>WBGene0000005</p></td>
<td><p>lincRNA</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="set-a-reference-table-as-default">
<h4>Set a Reference Table as default<a class="headerlink" href="#set-a-reference-table-as-default" title="Permalink to this headline">¶</a></h4>
<p>Once we have an Attribute and/or Biotype Reference Table, we can set it to be the default attribute reference table for all future uses of RNAlysis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">general</span>
<span class="n">general</span><span class="o">.</span><span class="n">set_reference_table_path</span><span class="p">(</span><span class="s1">&#39;path/to/my/reference/table.csv&#39;</span><span class="p">)</span>
<span class="c1">#TODO: update me!!!</span>
</pre></div>
</div>
<p>This will create a file called ‘settings.yaml’, which will store the full paths of your reference tables.
Whenever RNAlysis needs to use an attribute reference table and no other path is specified, RNAlysis will automatically use the path saved in the settings file.
The saved path can be changed any time using the general.set_reference_table_path() function.</p>
</div>
<div class="section" id="load-the-default-attribute-reference-table-path">
<h4>Load the default Attribute Reference Table path<a class="headerlink" href="#load-the-default-attribute-reference-table-path" title="Permalink to this headline">¶</a></h4>
<p>You can load the saved path from the settings file using the read_reference_table_path function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">general</span>
<span class="c1">#TODO: update me!</span>
</pre></div>
</div>
<p>If an attribute reference table path was not previously defined, you will be requested to define it when you run this function.</p>
</div>
</div>
<div class="section" id="parse-c-elegans-gene-names-wbgene-indices-and-sequence-names-using-regular-expressions">
<h3>Parse <em>C. elegans</em> gene names, WBGene indices and sequence names using regular expressions<a class="headerlink" href="#parse-c-elegans-gene-names-wbgene-indices-and-sequence-names-using-regular-expressions" title="Permalink to this headline">¶</a></h3>
<p>The general module includes functions which can parse <em>C. elegans</em> gene names (like <em>daf-2</em> or <em>lin-15B</em>), WBGene indices (like WBGene00023495) and sequence names (like Y55D5A.5 or T23G5.6).
For example, we could extract all WBGene indices from the following string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rnalysis</span> <span class="kn">import</span> <span class="n">general</span>
<span class="n">my_string</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;WBGene00000001 and WBGene00000002WBGene00000003</span>

<span class="s1">WBGene00000004g</span>
<span class="s1">&#39;&#39;&#39;</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">general</span><span class="o">.</span><span class="n">parse_wbgene_string</span><span class="p">(</span><span class="n">my_string</span><span class="p">)</span>
</pre></div>
</div>
<p>And the output would be the following set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;WBGene00000001&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene000000002&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00000003&#39;</span><span class="p">,</span><span class="s1">&#39;WBGene00000004&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Guy Teichman

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>